²>
PC:\Users\patrick.amorim\source\repos\ibge-api\Ibge.Api\Endpoints\CitiesModule.cs
	namespace		 	
Ibge		
 
.		 
Api		 
.		 
	Endpoints		 
;		 
public 
class 
CitiesModule 
: 
ICarterModule )
{ 
private 
readonly 
string 
Tag 
=  !
$str" (
;( )
public 

void 
	AddRoutes 
( !
IEndpointRouteBuilder /
app0 3
)3 4
{ 
app 
. 
MapPost 
( 
$str #
,# $
async% *
(+ ,
CreateCityCommand, =
model> C
,C D
[ 
FromServices 
] 
ICityServices (
	_services) 2
,2 3
CancellationToken 
cancellationToken /
)/ 0
=>1 3
{ 	
var 
result 
= 
await 
	_services (
.( )
Create) /
(/ 0
model0 5
,5 6
cancellationToken7 H
)H I
;I J
return 
result 
. 
ToMinimalApiResult ,
(, -
)- .
;. /
} 	
)	 

. 
Produces 
( 
$num 
) 
. 
Produces 
( 
$num 
) 
. 
Produces 
( 
$num 
) 
. 
WithTags 
( 
Tag 
) 
.  
RequireAuthorization !
(! "
)" #
;# $
app 
. 
MapGet 
( 
$str '
,' (
async) .
(/ 0
Guid0 4
id5 7
,7 8
[ 
FromServices 
] 
ICityServices (
_cityServices) 6
,6 7
CancellationToken   
cancellationToken   /
)  / 0
=>  1 3
{!! 	
var"" 
result"" 
="" 
await"" 
_cityServices"" ,
."", -
GetById""- 4
(""4 5
id""5 7
,""7 8
cancellationToken""9 J
)""J K
;""K L
return$$ 
result$$ 
.$$ 
ToMinimalApiResult$$ ,
($$, -
)$$- .
;$$. /
}%% 	
)%%	 

.&& 
Produces&& 
<&& 
CityResponseDto&& %
>&&% &
(&&& '
$num&&' *
)&&* +
.'' 
Produces'' 
('' 
$num'' 
)'' 
.(( 
WithTags(( 
((( 
Tag(( 
)(( 
.))  
RequireAuthorization)) !
())! "
)))" #
;))# $
app++ 
.++ 
MapGet++ 
(++ 
$str++ "
,++" #
async++$ )
(++* +
Guid+++ /
?++/ 0
id++1 3
,++3 4
int,, 
?,, 
code,, 
,,, 
string-- 
?-- 
name-- 
,-- 
Guid.. 
?.. 
stateId.. 
,.. 
int// 
?// 
page// 
,// 
int00 
?00 
size00 
,00 
[11 
FromServices11 
]11 
ICityServices11 (
_cityServices11) 6
,116 7
CancellationToken22 
cancellationToken22 /
)22/ 0
=>221 3
{33 	
var44 
result44 
=44 
await44 
_cityServices44 ,
.44, -
Get44- 0
(440 1
new441 4
(444 5
id445 7
,447 8
code449 =
,44= >
name44? C
,44C D
stateId44E L
,44L M
page44N R
??44S U
$num44V W
,44W X
size44Y ]
??44^ `
$num44a c
)44c d
,44d e
cancellationToken44f w
)44w x
;44x y
return66 
result66 
.66 
ToMinimalApiResult66 ,
(66, -
)66- .
;66. /
}77 	
)77	 

.88 
Produces88 
<88 
PagedResponseDto88 &
<88& '
CityResponseDto88' 6
>886 7
>887 8
(888 9
$num889 <
)88< =
.99 
WithTags99 
(99 
Tag99 
)99 
.::  
RequireAuthorization:: !
(::! "
)::" #
;::# $
app== 
.== 
MapPut== 
(== 
$str== '
,==' (
async==) .
(==/ 0
Guid==0 4
id==5 7
,==7 8
UpdateCityCommand>> 
model>> #
,>># $
[?? 
FromServices?? 
]?? 
ICityServices?? (
	_services??) 2
,??2 3
CancellationToken@@ 
cancellationToken@@ /
)@@/ 0
=>@@1 3
{AA 	
ifBB 
(BB 
idBB 
!=BB 
modelBB 
.BB 
IdBB 
)BB 
returnCC 
ResultsCC 
.CC 
ConflictCC '
(CC' (
)CC( )
;CC) *
varEE 
resultEE 
=EE 
awaitEE 
	_servicesEE (
.EE( )
UpdateEE) /
(EE/ 0
modelEE0 5
,EE5 6
cancellationTokenEE7 H
)EEH I
;EEI J
returnGG 
resultGG 
.GG 
ToMinimalApiResultGG ,
(GG, -
)GG- .
;GG. /
}II 	
)II	 

.JJ 
ProducesJJ 
(JJ 
$numJJ 
)JJ 
.KK 
ProducesKK 
(KK 
$numKK 
)KK 
.LL 
ProducesLL 
(LL 
$numLL 
)LL 
.MM 
WithTagsMM 
(MM 
TagMM 
)MM 
.NN  
RequireAuthorizationNN !
(NN! "
)NN" #
;NN# $
appPP 
.PP 
	MapDeletePP 
(PP 
$strPP *
,PP* +
asyncPP, 1
(PP2 3
GuidPP3 7
idPP8 :
,PP: ;
[QQ 
FromServicesQQ 
]QQ 
ICityServicesQQ (
	_servicesQQ) 2
,QQ2 3
CancellationTokenRR 
cancellationTokenRR /
)RR/ 0
=>RR1 3
{SS 	
varTT 
modelTT 
=TT 
newTT 
RemoveCityCommandTT -
(TT- .
)TT. /
{UU 
IdVV 
=VV 
idVV 
}WW 
;WW 
varYY 
resultYY 
=YY 
awaitYY 
	_servicesYY (
.YY( )
RemoveYY) /
(YY/ 0
modelYY0 5
,YY5 6
cancellationTokenYY7 H
)YYH I
;YYI J
return[[ 
result[[ 
.[[ 
ToMinimalApiResult[[ ,
([[, -
)[[- .
;[[. /
}\\ 	
)\\	 

.]] 
Produces]] 
(]] 
$num]] 
)]] 
.^^ 
Produces^^ 
(^^ 
$num^^ 
)^^ 
.__ 
Produces__ 
(__ 
$num__ 
)__ 
.`` 
WithTags`` 
(`` 
Tag`` 
)`` 
.aa  
RequireAuthorizationaa !
(aa! "
)aa" #
;aa# $
}bb 
}cc Ý
PC:\Users\patrick.amorim\source\repos\ibge-api\Ibge.Api\Endpoints\ImportModule.cs
	namespace 	
Ibge
 
. 
Api 
. 
	Endpoints 
; 
public 
class 
ImportModule 
: 
ICarterModule )
{		 
private

 
readonly

 
string

 
Tag

 
=

  !
$str

" *
;

* +
public 

void 
	AddRoutes 
( !
IEndpointRouteBuilder /
app0 3
)3 4
{ 
app 
. 
MapPost 
( 
$str (
,( )
async* /
(0 1
HttpContext1 <
context= D
,D E
[ 
FromServices 
] 
IImportServices )
services* 2
,2 3
CancellationToken 
cancellationToken .
). /
=>0 2
{ 	
var 
id 
= 
Guid 
. 
NewGuid !
(! "
)" #
;# $
var 
formFile 
= 
context "
." #
Request# *
.* +
Form+ /
./ 0
Files0 5
[5 6
$str6 <
]< =
;= >
if 
( 
formFile 
is 
not 
null  $
&&% '
formFile( 0
.0 1
Length1 7
>8 9
$num: ;
); <
{ 
if 
( 
! 
formFile 
. 
FileName &
.& '
Contains' /
(/ 0
$str0 7
)7 8
)8 9
return 
Results "
." #

StatusCode# -
(- .
$num. 1
)1 2
;2 3
await 
services 
. 
ProccessFile +
(+ ,
id, .
,. /
formFile0 8
,8 9
cancellationToken: K
)K L
;L M
var 
result 
= 
new  
{ 
Id 
= 
id 
, 
Message 
= 
$str -
} 
; 
return!! 
Results!! 
.!! 
Accepted!! '
(!!' (
$str!!( *
,!!* +
result!!, 2
)!!2 3
;!!3 4
}"" 
return## 
Results## 
.## 

BadRequest## %
(##% &
$str##& A
)##A B
;##B C
}%% 	
)%%	 

.&& 
Produces&& 
(&& 
$num&& 
)&& 
.'' 
Produces'' 
('' 
$num'' 
)'' 
.(( 
Produces(( 
((( 
$num(( 
)(( 
.)) 
WithTags)) 
()) 
Tag)) 
))) 
.**  
RequireAuthorization**  
(**  !
)**! "
;**" #
}++ 
},, ’;
PC:\Users\patrick.amorim\source\repos\ibge-api\Ibge.Api\Endpoints\StatesModule.cs
	namespace		 	
Ibge		
 
.		 
Api		 
.		 
	Endpoints		 
;		 
public 
class 
StatesModule 
: 
ICarterModule )
{ 
private 
readonly 
string 
Tag 
=  !
$str" )
;) *
public 

void 
	AddRoutes 
( !
IEndpointRouteBuilder /
app0 3
)3 4
{ 
app 
. 
MapPost 
( 
$str #
,# $
async% *
(+ ,
CreateStateCommand, >
model? D
,D E
[ 
FromServices 
] 
IStateServices )
	_services* 3
,3 4
CancellationToken 
cancellationToken /
)/ 0
=>1 3
{ 	
var 
result 
= 
await 
	_services (
.( )
Create) /
(/ 0
model0 5
,5 6
cancellationToken7 H
)H I
;I J
return 
result 
. 
ToMinimalApiResult ,
(, -
)- .
;. /
} 	
)	 

. 
Produces 
( 
$num 
) 
. 
Produces 
( 
$num 
) 
. 
Produces 
( 
$num 
) 
. 
WithTags 
( 
Tag 
) 
; 
app 
. 
MapGet 
( 
$str '
,' (
async) .
(/ 0
Guid0 4
id5 7
,7 8
[ 
FromServices 
] 
IStateServices )
	_services* 3
,3 4
CancellationToken   
cancellationToken   /
)  / 0
=>  1 3
{!! 	
var"" 
result"" 
="" 
await"" 
	_services"" (
.""( )
GetById"") 0
(""0 1
id""1 3
,""3 4
cancellationToken""5 F
)""F G
;""G H
return$$ 
result$$ 
.$$ 
ToMinimalApiResult$$ ,
($$, -
)$$- .
;$$. /
}%% 	
)%%	 

.&& 
Produces&& 
<&& 
StateResponseDto&& &
>&&& '
(&&' (
$num&&( +
)&&+ ,
.'' 
Produces'' 
('' 
$num'' 
)'' 
.(( 
WithTags(( 
((( 
Tag(( 
)(( 
;(( 
app** 
.** 
MapGet** 
(** 
$str** "
,**" #
async**$ )
(*** +
Guid**+ /
?**/ 0
id**1 3
,**3 4
int++ 
?++ 
code++ 
,++ 
string,, 
?,, 
name,, 
,,, 
string-- 
?-- 
acronym-- 
,-- 
int.. 
?.. 
page.. 
,.. 
int// 
?// 
size// 
,// 
[00 
FromServices00 
]00 
IStateServices00 )
	_services00* 3
,003 4
CancellationToken11 
cancellationToken11 /
)11/ 0
=>111 3
{22 	
var33 
result33 
=33 
await33 
	_services33 (
.33( )
Get33) ,
(33, -
new33- 0
(330 1
id331 3
,333 4
code335 9
,339 :
name33; ?
,33? @
acronym33A H
,33H I
page33J N
??33O Q
$num33R S
,33S T
size33U Y
??33Z \
$num33] _
)33_ `
,33` a
cancellationToken33b s
)33s t
;33t u
return55 
result55 
.55 
ToMinimalApiResult55 ,
(55, -
)55- .
;55. /
}66 	
)66	 

.77 
Produces77 
<77 
PagedResult77 !
<77! "
IEnumerable77" -
<77- .
StateResponseDto77. >
>77> ?
>77? @
>77@ A
(77A B
$num77B E
)77E F
.88 
WithTags88 
(88 
Tag88 
)88 
;88 
app:: 
.:: 
MapPut:: 
(:: 
$str:: '
,::' (
async::) .
(::/ 0
Guid::0 4
id::5 7
,::7 8
UpdateStateCommand;; 
model;; $
,;;$ %
[<< 
FromServices<< 
]<< 
IStateServices<< )
	_services<<* 3
,<<3 4
CancellationToken== 
cancellationToken== /
)==/ 0
=>==1 3
{>> 	
if?? 
(?? 
id?? 
!=?? 
model?? 
.?? 
Id?? 
)?? 
return@@ 
Results@@ 
.@@ 
Conflict@@ '
(@@' (
)@@( )
;@@) *
varBB 
resultBB 
=BB 
awaitBB 
	_servicesBB (
.BB( )
UpdateBB) /
(BB/ 0
modelBB0 5
,BB5 6
cancellationTokenBB7 H
)BBH I
;BBI J
returnDD 
resultDD 
.DD 
ToMinimalApiResultDD ,
(DD, -
)DD- .
;DD. /
}FF 	
)FF	 

.GG 
ProducesGG 
(GG 
$numGG 
)GG 
.HH 
ProducesHH 
(HH 
$numHH 
)HH 
.II 
ProducesII 
(II 
$numII 
)II 
.JJ 
WithTagsJJ 
(JJ 
TagJJ 
)JJ 
;JJ 
appLL 
.LL 
	MapDeleteLL 
(LL 
$strLL *
,LL* +
asyncLL, 1
(LL2 3
GuidLL3 7
idLL8 :
,LL: ;
[MM 
FromServicesMM 
]MM 
IStateServicesMM )
	_servicesMM* 3
,MM3 4
CancellationTokenNN 
cancellationTokenNN /
)NN/ 0
=>NN1 3
{OO 	
varPP 
modelPP 
=PP 
newPP 
RemoveStateCommandPP .
(PP. /
)PP/ 0
{QQ 
IdRR 
=RR 
idRR 
}SS 
;SS 
awaitUU 
	_servicesUU 
.UU 
RemoveUU "
(UU" #
modelUU# (
,UU( )
cancellationTokenUU* ;
)UU; <
;UU< =
returnWW 
ResultsWW 
.WW 
OkWW 
(WW 
)WW 
;WW  
}XX 	
)XX	 

.YY 
ProducesYY 
(YY 
$numYY 
)YY 
.ZZ 
ProducesZZ 
(ZZ 
$numZZ 
)ZZ 
.[[ 
Produces[[ 
([[ 
$num[[ 
)[[ 
.\\ 
WithTags\\ 
(\\ 
Tag\\ 
)\\ 
;\\ 
}]] 
}^^ ¨
OC:\Users\patrick.amorim\source\repos\ibge-api\Ibge.Api\Endpoints\UsersModule.cs
	namespace 	
Ibge
 
. 
Api 
. 
	Endpoints 
; 
public		 
class		 
UsersModule		 
:		 
ICarterModule		 (
{

 
private 
readonly 
string 
Tag 
=  !
$str" (
;( )
public 

void 
	AddRoutes 
( !
IEndpointRouteBuilder /
app0 3
)3 4
{ 
app 
. 
MapPost 
( 
$str "
," #
async$ )
(* +
CreateUserCommand+ <
command= D
,D E
[ 
FromServices 
] 
IUserServices (
	_services) 2
,2 3
CancellationToken 
cancellationToken /
)/ 0
=>1 3
{ 	
var 
result 
= 
await 
	_services (
.( )
Create) /
(/ 0
command0 7
,7 8
cancellationToken9 J
)J K
;K L
return 
result 
. 
ToMinimalApiResult ,
(, -
)- .
;. /
} 	
)	 

. 
Produces 
( 
$num 
) 
. 
Produces 
( 
$num 
) 
. 
WithTags 
( 
Tag 
) 
. 
AllowAnonymous 
( 
) 
; 
app 
. 
MapPost 
( 
$str '
,' (
async) .
(/ 0
AuthUserCommand0 ?
command@ G
,G H
[ 
FromServices 
] 
IUserServices (
	_services) 2
,2 3
CancellationToken 
cancellationToken /
)/ 0
=>1 3
{ 	
var   
result   
=   
await   
	_services   (
.  ( )
Auth  ) -
(  - .
command  . 5
,  5 6
cancellationToken  7 H
)  H I
;  I J
return"" 
result"" 
."" 
ToMinimalApiResult"" ,
("", -
)""- .
;"". /
}## 	
)##	 

.$$ 
Produces$$ 
($$ 
$num$$ 
)$$ 
.%% 
Produces%% 
(%% 
$num%% 
)%% 
.&& 
WithTags&& 
(&& 
Tag&& 
)&& 
.'' 
AllowAnonymous'' 
('' 
)'' 
;'' 
}(( 
})) Ç
]C:\Users\patrick.amorim\source\repos\ibge-api\Ibge.Api\Extension\JwtConfigurationExtension.cs
	namespace 	
Ibge
 
. 
Api 
. 
	Extension 
; 
public 
static 
class %
JwtConfigurationExtension -
{ 
public 

static 
IServiceCollection $&
ConfigureAddAuthentication% ?
(? @
this@ D
IServiceCollectionE W
servicesX `
,` a
IConfigurationb p
configurationq ~
)~ 
{		 
services

 
.

 
AddAuthentication

 "
(

" #
$str

# +
)

+ ,
. 
AddJwtBearer 
( 
$str "
," #
options$ +
=>, .
{ 
options 
. %
TokenValidationParameters 1
=2 3
new4 7%
TokenValidationParameters8 Q
{ 
ValidateAudience $
=% &
false' ,
,, -
ValidateIssuer "
=# $
false% *
,* +
ValidateLifetime $
=% &
true' +
,+ ,$
ValidateIssuerSigningKey ,
=- .
true/ 3
,3 4
IssuerSigningKey $
=% &
new' * 
SymmetricSecurityKey+ ?
(? @
Encoding@ H
.H I
UTF8I M
.M N
GetBytesN V
(V W
configurationW d
[d e
$stre u
]u v
)v w
)w x
,x y
} 
; 
} 
) 
; 
return 
services 
; 
} 
} Ø)
AC:\Users\patrick.amorim\source\repos\ibge-api\Ibge.Api\Program.cs
var

 
builder

 
=

 
WebApplication

 
.

 
CreateBuilder

 *
(

* +
args

+ /
)

/ 0
;

0 1
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
options &
=>' )
{ 
options 
. !
AddSecurityDefinition !
(! "
$str" *
,* +
new, /!
OpenApiSecurityScheme0 E
{ 
Type 
= 
SecuritySchemeType !
.! "
Http" &
,& '
Scheme 
= 
$str 
, 
BearerFormat 
= 
$str 
, 
Name 
= 
$str 
, 
In 

= 
ParameterLocation 
. 
Header %
,% &
Description 
= 
$str 0
,0 1
} 
) 
; 
options 
. "
AddSecurityRequirement "
(" #
new# &&
OpenApiSecurityRequirement' A
{ 
{ 	
new !
OpenApiSecurityScheme %
{ 
	Reference 
= 
new 
OpenApiReference  0
{ 
Type   
=   
ReferenceType   (
.  ( )
SecurityScheme  ) 7
,  7 8
Id!! 
=!! 
$str!! !
,!!! "
}"" 
,"" 
}## 
,## 
Array$$ 
.$$ 
Empty$$ 
<$$ 
string$$ 
>$$ 
($$  
)$$  !
}%% 	
,%%	 

}&& 
)&& 
;&& 
}'' 
)'' 
;'' 
builder** 
.** 
Services** 
.** 
AddAuthorization** !
(**! "
)**" #
;**# $
builder++ 
.++ 
Services++ 
.++ &
ConfigureAddAuthentication++ +
(+++ ,
builder++, 3
.++3 4
Configuration++4 A
)++A B
;++B C
builder-- 
.-- 
Services-- 
.-- 
	AddCarter-- 
(-- 
)-- 
;-- 
builder.. 
... 
Services.. 
...  
ConfigureApplication.. %
(..% &
builder..& -
...- .
Configuration... ;
)..; <
.// 
ConfigureInfra// 
(//  
builder//  '
.//' (
Configuration//( 5
)//5 6
;//6 7
builder11 
.11 
Services11 
.11 -
!AddFluentValidationAutoValidation11 2
(112 3
)113 4
;114 5
builder22 
.22 
Services22 
.22 /
#AddValidatorsFromAssemblyContaining22 4
<224 5
Program225 <
>22< =
(22= >
)22> ?
;22? @
builder44 
.44 
Services44 
.44 
	Configure44 
<44 
FormOptions44 &
>44& '
(44' (
options44( /
=>440 2
{55 
options66 
.66 
ValueLengthLimit66 
=66 
int66 "
.66" #
MaxValue66# +
;66+ ,
options77 
.77 $
MultipartBodyLengthLimit77 $
=77% &
$num77' 0
;770 1
}88 
)88 
;88 
builder:: 
.:: 
Services:: 
.:: 
	Configure:: 
<:: 
IISServerOptions:: +
>::+ ,
(::, -
options::- 4
=>::5 7
{;; 
options<< 
.<< 
MaxRequestBodySize<< 
=<<  
$num<<! )
;<<) *
}== 
)== 
;== 
var?? 
app?? 
=?? 	
builder??
 
.?? 
Build?? 
(?? 
)?? 
;?? 
ifAA 
(AA 
appAA 
.AA 
EnvironmentAA 
.AA 
IsDevelopmentAA !
(AA! "
)AA" #
)AA# $
{BB 
appCC 
.CC 

UseSwaggerCC 
(CC 
)CC 
;CC 
appDD 
.DD 
UseSwaggerUIDD 
(DD 
)DD 
;DD 
}EE 
appGG 
.GG 
UseAuthenticationGG 
(GG 
)GG 
;GG 
appHH 
.HH 
UseAuthorizationHH 
(HH 
)HH 
;HH 
appJJ 
.JJ 
UseHttpsRedirectionJJ 
(JJ 
)JJ 
;JJ 
appLL 
.LL 
	MapCarterLL 
(LL 
)LL 
;LL 
appNN 
.NN 
RunNN 
(NN 
)NN 	
;NN	 
